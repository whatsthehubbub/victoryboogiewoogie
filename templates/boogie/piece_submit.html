{% extends "base.html" %}
{% load url from future %}

{% block pagetitle %}Schrijven{% endblock pagetitle %}

{% block extrahead %}
	<script type="text/javascript">

	$(document).ready(function() {
		$('#id_genre').change(function() {

			if ($('#id_genre').val() === 'Headline') {
				$('#id_text').parent().slideUp();
			} else {
				$('#id_text').parent().slideDown();
			}
		});
	});

	</script>
{% endblock extrahead %}


{% block bodyid %}piece_submit{% endblock %}

{% block content %}
<div class="box">
	<div class="row">
		<div class="span8 offset2">
			
			<!-- TODO: Show progress towards event for selected topic. Not sure how we're going to turn a numbers into a progress bar, I'll leave that up to Simon.  -->
			<!-- TODO: Show deadline for submission. -->
			<!-- TODO: Include character count. -->
			
			{% if form %}
				{% ifequal current_player.role 'WRITER' %}
					<h2 class="text-center">Schrijf een gebeurtenis</h2>
				{% endifequal %}
				
				{% ifequal current_player.role 'PLAYER' %}
					<h2 class="text-center">Schrijf iets nieuws over {{ form.instance.topic.title }}</h2>
					
					<p class="lead">Dit is je kans! Schrijf een kek stukje over het onderwerp {{ form.instance.topic.title }}. Je kan kiezen uit verschillende genres, <em>anything goes</em>.</p>
					<p>Houd rekening met wat er vooraf is gegaan in het algemeen, en over dit onderwerp in het bijzonder. Na inzending buigt de redactie zich over je stukje, en krijg je een email zodra deze is geplaatst of als ze willen dat je het aanpast, of als ze hebben besloten hem af te wijzen. Zet hem op!</p>
					
					<hr>
					
					<!-- TODO: Hook the links below up to the corresponding pages. -->
					
					{% if form.instance.topic.get_latest_piece %}
						<p>Lees het <a href="{% url 'piece_detail' form.instance.topic.get_latest_piece.id %}">laatste stukje</a> over dit onderwerp.
					{% endif %}

					Of bekijk het archief van <a href="{% url 'topic_detail' form.instance.topic.id form.instance.topic.slug %}">alle stukjes</a> over dit onderwerp.</p>
					
					<p>Deadline in {{ form.instance.deadline|timeuntil }}</p>

					<p>Voortgang tot gebeurtenis</p>
					<p>{{ form.instance.topic.piece_count }} / {{ form.instance.topic.piece_threshold }}</p>
				{% endifequal %}

				<form action="{% url 'piece_submit' %}" method="post">
					{% csrf_token %}
					{{ form.as_ul }}
					<input type="submit" value="Submit">
				</form>
				<p id="char_counter"></p>
			{% else %}
				<p>Je mag op dit moment niks schrijven.</p>
			{% endif %}
			
		</div>
	</div>
</div>
{% endblock %}